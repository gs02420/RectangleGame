<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My First Game</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Journey To Mental Stability!</h1>
    <canvas id="gameCanvas" width="600" height="400"></canvas>
    <p id="score">Stability level = 0</p>

    <script>const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreElement = document.getElementById('score');

let score = 0;
let playerY = 150;
let isJump  = false;
let playerSize;
const gravity = 0.5;
let velocityY = 0;
let Enemys= [
    new Obstical(50, 50, canvas.width,canvas.height - 50,2),
    new Obstical(50, 50, canvas.width + 300,canvas.height - 50,2)
];
function Obstical(width, height, x, y, speed){
  this.speed = speed;
  this.width = width;
  this.height = height;
  this.x = x;
  this.y = canvas.height - height;
}
const nextFrame = () => new Promise(requestAnimationFrame);


async function delayFrames(frames) {
  for (let i = 0; i < frames; i++) {
    await nextFrame();
  }
}
function bottomLine(){
    ctx.strokeStyle = 'black';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(0, canvas.height - 1);
    ctx.lineTo(canvas.width, canvas.height - 1);
    ctx.stroke();
}
function updateGame(){
            if (isJump) {
            velocityY += gravity;
            playerY += velocityY;

            if (playerY >= canvas.height - playerSize) {
                playerY = canvas.height - playerSize;
                isJump = false;
                velocityY = 0;
            }
        } else {
             playerY = canvas.height - playerSize;
        }

    Enemys.forEach( enemy => {
        enemy.x -= enemy.speed;
                    if (enemy.x < -enemy.width) {
                enemy.x = canvas.width + Math.random() * 200 + 100;
                score++;
                    }
    if(
        50 < enemy.x + enemy.width &&
        50 + playerSize > enemy.x && playerY < enemy.y + enemy.height && playerY + playerSize > enemy.y
    ) {
        score = 0;
        console.log ("Collision",score)
    }
});
    scoreElement.textContent = `stability level = ${score}`;


}

function drawGame(){
    ctx.clearRect(0, 0,canvas.width, canvas.height);

    bottomLine();

    ctx.fillStyle = 'blue';
    ctx.fillRect(50, playerY, playerSize, playerSize);

 
    ctx.fillStyle = 'red';
    Enemys.forEach( enemy => {

        ctx.fillRect(enemy.x,enemy.y, enemy.width, enemy.height);
    });
}
function gameLoop(){
    updateGame();

    drawGame();

    requestAnimationFrame(gameLoop);
}
document.addEventListener('keydown',(event) =>{
    if(event.code === "Space" && !isJump){
        isJump = true;

        velocityY = -10;
    }
});
gameLoop();
</script>
</body>
</html>
